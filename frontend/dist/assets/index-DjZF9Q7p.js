import{j as e,O as S,r as d,V as h,u as y,N as T,b as O,d as U,R as k,e as B,f as M}from"./react-vendor-Bhc0RHXR.js";import{a as A,R as I,b as q,c as K,C as Y,T as R,L as E,B as G,e as V,X as _,Y as X,f as L}from"./vendor-BaYS2EzJ.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const n of a)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function o(a){const n={};return a.integrity&&(n.integrity=a.integrity),a.referrerPolicy&&(n.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?n.credentials="include":a.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(a){if(a.ep)return;a.ep=!0;const n=o(a);fetch(a.href,n)}})();function Q(){return e.jsx("div",{className:"bg-gray-700",children:e.jsx(S,{})})}const b=A.create({baseURL:"http://localhost:3000/api/v1",withCredentials:!0}),W=async t=>b.post("/user/register",t),Z=async t=>b.post("/user/login",t),P=async()=>b.delete("/user/logout"),v=async()=>b.get("/user/profile"),$=d.createContext(),z=({children:t})=>{const[r,o]=d.useState(null),[s,a]=d.useState(!0),n=async()=>{try{const i=await v();o(i.data.data)}catch{o(null)}finally{a(!1)}};d.useEffect(()=>{n()},[]);const c=async()=>{try{await P(),o(null),h.success("Logged out successfully!")}catch{h.error("Logout failed!")}};return e.jsx($.Provider,{value:{user:r,setUser:o,loading:s,logout:c},children:t})},p=()=>d.useContext($);function H(){var s;const{user:t,logout:r}=p(),o=y();return e.jsxs("nav",{className:"flex justify-between items-center p-2 bg-green-600 text-white",children:[e.jsxs("div",{className:"text-lg font-bold flex items-center gap-2 cursor-pointer",onClick:()=>o("/dashboard"),children:[e.jsx("img",{src:"https://marketplace.canva.com/EAGQZhT83lg/1/0/1600w/canva-dark-green-modern-illustrative-finance-service-logo-GTKa2Yxea4Y.jpg",alt:"Finance Logo",className:"w-14 h-14 rounded-full"}),e.jsxs("span",{className:"text-2xl",children:["Personal ",e.jsx("span",{className:"text-[#023126]",children:"Finance"})," Tracker"]})]}),t&&e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("img",{src:`https://ui-avatars.com/api/?name=${encodeURIComponent((s=t.name)==null?void 0:s.charAt(0))}&background=0D8ABC&color=fff`,alt:"User Avatar",className:"w-10 h-10 rounded-full cursor-pointer border-2 border-white hover:scale-105 transition-transform",onClick:()=>o("/profile")}),e.jsx("button",{onClick:r,className:"bg-red-500 hover:bg-red-700 px-4 py-2 rounded",children:"Logout"})]})]})}const J=()=>e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx(H,{}),e.jsx("main",{className:"flex-1 ",children:e.jsx(S,{})})]}),C=A.create({baseURL:"http://localhost:3000/api/v1",withCredentials:!0}),ee=()=>C.get("/transactions"),te=t=>C.post("/transactions",t),se=t=>C.delete(`/transactions/${t}`);function ae({onSubmit:t}){const[r,o]=d.useState({amount:"",type:"income",category:"",note:"",date:new Date().toISOString().slice(0,10)}),[s,a]=d.useState(!1),n=i=>{o(m=>({...m,[i.target.name]:i.target.value}))},c=async i=>{if(i.preventDefault(),!r.amount||!r.type||!r.category){alert("Please fill required fields");return}a(!0),await t(r),a(!1),o({amount:"",type:"income",category:"",note:"",date:new Date().toISOString().slice(0,10)})};return e.jsxs("form",{onSubmit:c,className:"mb-6 space-y-4 border p-4 rounded bg-white shadow",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("input",{type:"number",name:"amount",placeholder:"Amount",value:r.amount,onChange:n,required:!0,className:"flex-1 border px-3 py-2 rounded"}),e.jsxs("select",{name:"type",value:r.type,onChange:n,className:"border px-3 py-2 rounded",children:[e.jsx("option",{value:"income",children:"Income"}),e.jsx("option",{value:"expense",children:"Expense"})]})]}),e.jsx("input",{type:"text",name:"category",placeholder:"Category",value:r.category,onChange:n,required:!0,className:"w-full border px-3 py-2 rounded"}),e.jsx("input",{type:"text",name:"note",placeholder:"Note (optional)",value:r.note,onChange:n,className:"w-full border px-3 py-2 rounded"}),e.jsx("input",{type:"date",name:"date",value:r.date,onChange:n,className:"w-full border px-3 py-2 rounded"}),e.jsx("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",disabled:s,children:s?"Saving...":"Add Transaction"})]})}function F({transaction:t,onDelete:r}){const o=new Intl.DateTimeFormat("en-IN",{year:"numeric",month:"short",day:"numeric"}),s=new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",maximumFractionDigits:2});return e.jsxs("li",{className:`flex justify-between items-center border rounded p-3 bg-white shadow ${t.type==="income"?"text-green-700":"text-red-700"}`,children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold",children:[t.type==="income"?"+":"-",s.format(t.amount)," - ",t.category]}),t.note&&e.jsx("p",{className:"text-sm text-gray-600",children:t.note}),e.jsx("p",{className:"text-xs text-gray-400",children:o.format(new Date(t.date))})]}),e.jsx("button",{onClick:()=>r(t._id),className:"text-red-600 hover:text-red-800 font-semibold",children:"Delete"})]})}function ne({transactions:t,loading:r,onDelete:o}){const[s,a]=d.useState({startDate:"",endDate:"",category:"",type:"all"}),[n,c]=d.useState([]);d.useEffect(()=>{let l=[...t];s.type!=="all"&&(l=l.filter(u=>u.type===s.type)),s.category.trim()!==""&&(l=l.filter(u=>u.category.toLowerCase().includes(s.category.toLowerCase()))),s.startDate&&(l=l.filter(u=>new Date(u.date)>=new Date(s.startDate))),s.endDate&&(l=l.filter(u=>new Date(u.date)<=new Date(s.endDate))),c(l)},[s,t]);const i=l=>{a(u=>({...u,[l.target.name]:l.target.value}))},m=n.filter(l=>l.type==="income"),g=n.filter(l=>l.type==="expense");return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 p-4 bg-gray-100 rounded shadow flex flex-wrap gap-4 justify-center",children:[e.jsxs("select",{name:"type",value:s.type,onChange:i,className:"border px-3 py-2 rounded",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"income",children:"Income"}),e.jsx("option",{value:"expense",children:"Expense"})]}),e.jsx("input",{type:"text",name:"category",placeholder:"Filter by Category",value:s.category,onChange:i,className:"border px-3 py-2 rounded"}),e.jsx("input",{type:"date",name:"startDate",value:s.startDate,onChange:i,className:"border px-3 py-2 rounded",max:s.endDate||void 0}),e.jsx("input",{type:"date",name:"endDate",value:s.endDate,onChange:i,className:"border px-3 py-2 rounded",min:s.startDate||void 0})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsxs("section",{className:"flex-1 bg-green-50 p-4 rounded shadow max-h-[60vh] overflow-auto",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4 text-green-700",children:"Income"}),r&&e.jsx("p",{children:"Loading transactions..."}),!r&&m.length===0&&e.jsx("p",{children:"No income transactions found."}),e.jsx("ul",{className:"space-y-3",children:m.map(l=>e.jsx(F,{transaction:l,onDelete:o},l._id))})]}),e.jsxs("section",{className:"flex-1 bg-red-50 p-4 rounded shadow max-h-[60vh] overflow-auto",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4 text-red-700",children:"Expenses"}),r&&e.jsx("p",{children:"Loading transactions..."}),!r&&g.length===0&&e.jsx("p",{children:"No expense transactions found."}),e.jsx("ul",{className:"space-y-3",children:g.map(l=>e.jsx(F,{transaction:l,onDelete:o},l._id))})]})]})]})}const D=["#0088FE","#00C49F","#FFBB28","#FF8042","#AA00FF","#FF00AA","#00FFAA","#AAFF00"];function re({transactions:t}){const o=t.filter(a=>a.type==="expense").reduce((a,n)=>(a[n.category]=(a[n.category]||0)+Number(n.amount),a),{}),s=Object.entries(o).map(([a,n])=>({name:a,value:n}));return s.length===0?e.jsx("p",{className:"text-center text-gray-600",children:"No expense data to show"}):e.jsx(I,{width:"100%",height:350,children:e.jsxs(q,{children:[e.jsx(K,{data:s,cx:"50%",cy:"50%",labelLine:!1,label:({name:a,percent:n})=>`${a} ${(n*100).toFixed(0)}%`,outerRadius:120,fill:"#8884d8",dataKey:"value",children:s.map((a,n)=>e.jsx(Y,{fill:D[n%D.length]},`cell-${n}`))}),e.jsx(R,{formatter:a=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(a)}),e.jsx(E,{})]})})}function oe({transactions:t}){const r={};t.forEach(s=>{const n=new Date(s.date).toLocaleString("default",{month:"short",year:"numeric"});r[n]||(r[n]={month:n,income:0,expense:0}),r[n][s.type]+=Number(s.amount)});const o=Object.values(r).sort((s,a)=>{const[n,c]=s.month.split(" "),[i,m]=a.month.split(" ");return new Date(`${n} 1, ${c}`)-new Date(`${i} 1, ${m}`)});return o.length===0?e.jsx("p",{className:"text-center text-gray-600",children:"No data to show monthly trends"}):e.jsx(I,{width:"100%",height:300,children:e.jsxs(G,{data:o,margin:{top:20,right:30,left:10,bottom:5},children:[e.jsx(V,{strokeDasharray:"3 3"}),e.jsx(_,{dataKey:"month"}),e.jsx(X,{}),e.jsx(R,{formatter:s=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR"}).format(s)}),e.jsx(E,{}),e.jsx(L,{dataKey:"income",stackId:"a",fill:"#82ca9d"}),e.jsx(L,{dataKey:"expense",stackId:"a",fill:"#ff7f7f"})]})})}function N({title:t,value:r,className:o}){return e.jsxs("div",{className:`p-4 rounded shadow flex flex-col items-center justify-center ${o}`,children:[e.jsx("h3",{className:"text-gray-600 mb-1",children:t}),e.jsx("p",{className:"text-2xl font-bold",children:r})]})}function le(){const[t,r]=d.useState([]),[o,s]=d.useState(!1),[a,n]=d.useState("add"),c=async()=>{s(!0);try{const x=await ee();r(x.data.data)}catch{h.error("Failed to load transactions")}s(!1)};d.useEffect(()=>{c()},[]);const i=async x=>{try{await te(x),h.success("Transaction added"),c(),n("list")}catch{h.error("Failed to add transaction")}},m=async x=>{if(window.confirm("Are you sure you want to delete this transaction?"))try{await se(x),h.success("Transaction deleted"),c()}catch{h.error("Failed to delete transaction")}},{totalIncome:g,totalExpense:l,balance:u}=d.useMemo(()=>{let x=0,w=0;for(const f of t)f.type==="income"?x+=Number(f.amount):f.type==="expense"&&(w+=Number(f.amount));return{totalIncome:x,totalExpense:w,balance:x-w}},[t]),j=x=>x.toLocaleString("en-IN",{style:"currency",currency:"INR"});return e.jsxs("div",{className:"max-w-6xl mx-auto p-4",children:[e.jsxs("div",{className:"flex flex-wrap justify-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>n("add"),className:`px-4 py-2 rounded font-medium ${a==="add"?"bg-blue-600 text-white":"bg-gray-200 text-gray-800"}`,children:"Add Transaction"}),e.jsx("button",{onClick:()=>n("list"),className:`px-4 py-2 rounded font-medium ${a==="list"?"bg-blue-600 text-white":"bg-gray-200 text-gray-800"}`,children:"Your Transactions"})]}),a==="add"&&e.jsx(ae,{onSubmit:i}),a==="list"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(N,{title:"Total Income",value:j(g),className:"bg-green-100 text-green-800"}),e.jsx(N,{title:"Total Expense",value:j(l),className:"bg-red-100 text-red-800"}),e.jsx(N,{title:"Balance",value:j(u),className:`${u>=0?"bg-blue-100 text-blue-800":"bg-red-200 text-red-900"}`})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto border rounded-md p-2 mb-8",children:e.jsx(ne,{transactions:t,loading:o,onDelete:m})}),e.jsxs("div",{className:"my-8 flex flex-col lg:flex-row gap-8 justify-center items-stretch",children:[e.jsxs("div",{className:"bg-white p-4 rounded shadow w-full lg:w-1/2",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 text-green-700",children:"Expenses by Category"}),e.jsx(re,{transactions:t})]}),e.jsxs("div",{className:"bg-white p-4 rounded shadow w-full lg:w-1/2",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4 text-blue-700",children:"Monthly Income & Expense Trends"}),e.jsx(oe,{transactions:t})]})]})]})]})}function ce(){const{user:t}=p();return e.jsx(e.Fragment,{children:e.jsx("div",{className:"p-8 min-h-[90vh] bg-gray-700",children:e.jsx(le,{})})})}const ie=()=>{var a;const[t,r]=d.useState(null),o=y();d.useEffect(()=>{v().then(n=>r(n.data.data)).catch(()=>o("/auth"))},[]);const s=async()=>{await P(),alert("Logged out"),o("/auth")};return t?e.jsxs("div",{className:"max-w-md mx-auto mt-10 bg-white shadow-md rounded-lg p-6 text-center",children:[e.jsx("img",{src:`https://ui-avatars.com/api/?name=${encodeURIComponent((a=t.name)==null?void 0:a.charAt(0))}&background=0D8ABC&color=fff`,alt:"User Avatar",className:"w-24 h-24 mx-auto rounded-full mb-4"}),e.jsxs("h2",{className:"text-2xl font-semibold text-green-700 mb-2",children:["Welcome, ",t.name]}),e.jsxs("p",{className:"text-gray-600 mb-6",children:["Email: ",t.email]}),e.jsx("button",{onClick:s,className:"bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-md",children:"Logout"})]}):e.jsx("p",{className:"text-center mt-10 text-gray-600 text-lg",children:"Loading..."})},de=()=>{const[t,r]=d.useState({name:"",email:"",password:""}),[o,s]=d.useState(!1),a=y(),n=async c=>{var i,m;c.preventDefault(),s(!0);try{await W(t),h.success("Registered successfully!"),a("/auth")}catch(g){h.error(((m=(i=g.response)==null?void 0:i.data)==null?void 0:m.message)||"Registration failed")}finally{s(!1)}};return e.jsxs("form",{onSubmit:n,className:"max-w-sm mx-auto p-6 bg-white rounded shadow space-y-6",children:[e.jsx("input",{type:"text",placeholder:"Name",required:!0,value:t.name,onChange:c=>r({...t,name:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("input",{type:"email",placeholder:"Email",required:!0,value:t.email,onChange:c=>r({...t,email:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("input",{type:"password",placeholder:"Password",required:!0,value:t.password,onChange:c=>r({...t,password:c.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{type:"submit",disabled:o,className:`w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 rounded transition ${o?"opacity-50 cursor-not-allowed":""}`,children:o?"Registering...":"Register"})]})},ue=()=>{const[t,r]=d.useState({email:"",password:""}),[o,s]=d.useState(!1),a=y(),{setUser:n}=p(),c=async i=>{var m,g,l;i.preventDefault(),s(!0);try{await Z(t);const u=await v();n(u.data.data),h.success("Logged in successfully!"),a("/dashboard")}catch(u){console.log((m=u.response)==null?void 0:m.data),h.error(((l=(g=u.response)==null?void 0:g.data)==null?void 0:l.message)||"Login failed")}finally{s(!1)}};return e.jsxs("form",{onSubmit:c,className:"max-w-sm mx-auto p-6 bg-white rounded shadow space-y-6",children:[e.jsx("input",{type:"email",placeholder:"Email",required:!0,value:t.email,onChange:i=>r({...t,email:i.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("input",{type:"password",placeholder:"Password",required:!0,value:t.password,onChange:i=>r({...t,password:i.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{type:"submit",disabled:o,className:`w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 rounded transition ${o?"opacity-50 cursor-not-allowed":""}`,children:o?"Logging in...":"Login"})]})},me=()=>{const[t,r]=d.useState("login");return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 px-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-md p-8 space-y-6",children:[e.jsx("h2",{className:"text-3xl font-semibold text-center text-gray-800",children:t==="login"?"Login":"Register"}),t==="login"?e.jsx(ue,{}):e.jsx(de,{}),e.jsxs("p",{className:"text-center text-gray-600",children:[t==="login"?"Don't have an account? ":"Already have an account? ",e.jsx("button",{onClick:()=>r(t==="login"?"register":"login"),className:"text-blue-600 hover:underline font-semibold focus:outline-none",children:t==="login"?"Register":"Login"})]})]})})},xe=({children:t})=>{const{user:r,loading:o}=p();return o?e.jsx("p",{children:"Loading..."}):r?t:e.jsx(T,{to:"/auth"})},he=({children:t})=>{const{user:r,loading:o}=p();return o?e.jsx("p",{children:"Loading..."}):r?e.jsx(T,{to:"/dashboard"}):t},ge=O([{path:"/",element:e.jsx(z,{children:e.jsx(Q,{})}),children:[{path:"",element:e.jsx(xe,{children:e.jsx(J,{})}),children:[{path:"dashboard",element:e.jsx(ce,{})},{path:"profile",element:e.jsx(ie,{})}]},{path:"auth",element:e.jsx(he,{children:e.jsx(me,{})})}]}]);U.createRoot(document.getElementById("root")).render(e.jsxs(k.StrictMode,{children:[e.jsx(B,{router:ge}),e.jsx(M,{position:"top-right"})]}));
